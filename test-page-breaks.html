<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test des Sauts de Page - WebKit vs WebEngine</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        .status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: bold;
            margin-left: 10px;
        }

        .works-webengine {
            background: #d4edda;
            color: #155724;
        }

        .fails-webkit {
            background: #f8d7da;
            color: #721c24;
        }

        .partial {
            background: #fff3cd;
            color: #856404;
        }

        /* TEST 1: break-before: page (√âCHOUE avec WebKit, OK avec WebEngine) */
        .test1-chapter {
            break-before: page;
            page-break-before: always; /* Fallback pour WebKit */
            padding: 20px;
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            margin: 20px 0;
        }

        /* TEST 2: break-after: page (√âCHOUE avec WebKit, OK avec WebEngine) */
        .test2-section {
            break-after: page;
            page-break-after: always; /* Fallback pour WebKit */
            padding: 20px;
            background: #f3e5f5;
            border-left: 4px solid #9c27b0;
            margin: 20px 0;
        }

        /* TEST 3: break-inside: avoid (OK avec WebKit patch√©, OK avec WebEngine) */
        .test3-keep-together {
            break-inside: avoid;
            page-break-inside: avoid; /* Fallback */
            padding: 20px;
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            margin: 20px 0;
            min-height: 500px; /* Force √† √™tre assez grand pour risquer une coupure */
        }

        /* TEST 4: break-inside: avoid avec display: flex (√âCHOUE PARTOUT!) */
        .test4-flex-container {
            display: flex;
            flex-direction: column;
            break-inside: avoid;
            page-break-inside: avoid;
            padding: 20px;
            background: #ffebee;
            border-left: 4px solid #f44336;
            margin: 20px 0;
            min-height: 500px;
        }

        /* TEST 5: break-inside: avoid-page (√âCHOUE avec WebKit, OK avec WebEngine) */
        .test5-avoid-page {
            break-inside: avoid-page;
            padding: 20px;
            background: #fff9c4;
            border-left: 4px solid #ffc107;
            margin: 20px 0;
            min-height: 500px;
        }

        /* TEST 6: break-before: left/right (√âCHOUE avec WebKit, OK avec WebEngine) */
        .test6-left-page {
            break-before: left;
            padding: 20px;
            background: #fce4ec;
            border-left: 4px solid #e91e63;
            margin: 20px 0;
        }

        /* TEST 7: Table avec break-inside (PROBL√âMATIQUE partout) */
        .test7-table {
            width: 100%;
            border-collapse: collapse;
            break-inside: avoid;
            page-break-inside: avoid;
            margin: 20px 0;
        }

        .test7-table th,
        .test7-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
            /* Ces propri√©t√©s NE FONCTIONNENT PAS dans les cellules */
            break-inside: avoid;
            page-break-inside: avoid;
        }

        .test7-table th {
            background: #607d8b;
            color: white;
        }

        .test7-table tr {
            break-inside: avoid;
            page-break-inside: avoid;
        }

        /* TEST 8: √âl√©ments imbriqu√©s complexes */
        .test8-complex {
            break-inside: avoid;
            page-break-inside: avoid;
            padding: 20px;
            background: #e0f7fa;
            border-left: 4px solid #00bcd4;
            margin: 20px 0;
        }

        .test8-complex img {
            max-width: 100%;
            height: auto;
            break-inside: avoid;
            page-break-inside: avoid;
        }

        /* TEST 9: orphans et widows (Support WebKit patch√© v0.12.1+) */
        .test9-orphans {
            orphans: 3;
            widows: 3;
            padding: 20px;
            background: #f1f8e9;
            border-left: 4px solid #8bc34a;
            margin: 20px 0;
        }

        /* TEST 10: break-before avec valeurs multiples */
        .test10-column-page {
            break-before: column;
            padding: 20px;
            background: #ede7f6;
            border-left: 4px solid #673ab7;
            margin: 20px 0;
        }

        h1 {
            color: #333;
            margin: 30px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #333;
            break-after: avoid;
            page-break-after: avoid;
        }

        h2 {
            color: #555;
            margin: 25px 0 15px 0;
            break-after: avoid;
            page-break-after: avoid;
        }

        h3 {
            color: #666;
            margin: 20px 0 10px 0;
            break-after: avoid;
            page-break-after: avoid;
        }

        p {
            margin: 10px 0;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }

        .legend {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .legend h3 {
            margin-top: 0;
        }

        .legend ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .filler {
            height: 400px;
            background: repeating-linear-gradient(
                45deg,
                #f0f0f0,
                #f0f0f0 10px,
                #ffffff 10px,
                #ffffff 20px
            );
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            color: #999;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>üß™ Test des Sauts de Page CSS</h1>

    <div class="legend">
        <h3>L√©gende</h3>
        <ul>
            <li><span class="status works-webengine">‚úì WebEngine</span> = Fonctionne avec Qt WebEngine (Chromium)</li>
            <li><span class="status fails-webkit">‚úó WebKit</span> = √âchoue avec Qt WebKit (m√™me patch√©)</li>
            <li><span class="status partial">‚ö† Partiel</span> = Support partiel ou conditionnel</li>
        </ul>
        <p><strong>Comment tester :</strong></p>
        <pre style="background: #f4f4f4; padding: 10px; overflow-x: auto;">
# Avec WebKit (ancien) - Beaucoup de tests √©choueront
wkhtmltopdf --render-backend webkit test-page-breaks.html webkit-output.pdf

# Avec WebEngine (nouveau) - La plupart des tests fonctionneront
wkhtmltopdf --render-backend webengine test-page-breaks.html webengine-output.pdf

# Comparez les deux PDFs pour voir les diff√©rences!</pre>
    </div>

    <div class="filler">Page 1 - Contenu de remplissage</div>

    <!-- TEST 1 -->
    <div class="test1-chapter">
        <h2>TEST 1: break-before: page
            <span class="status works-webengine">‚úì WebEngine</span>
            <span class="status fails-webkit">‚úó WebKit</span>
        </h2>
        <p><strong>Propri√©t√© test√©e :</strong> <code>break-before: page;</code></p>
        <p><strong>Attendu :</strong> Cette section devrait commencer sur une NOUVELLE page.</p>
        <p><strong>WebKit :</strong> Ignorera probablement cette propri√©t√© et continuera sur la m√™me page.</p>
        <p><strong>WebEngine :</strong> Respectera la propri√©t√© et forcera un saut de page avant.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
    </div>

    <!-- TEST 2 -->
    <div class="test2-section">
        <h2>TEST 2: break-after: page
            <span class="status works-webengine">‚úì WebEngine</span>
            <span class="status fails-webkit">‚úó WebKit</span>
        </h2>
        <p><strong>Propri√©t√© test√©e :</strong> <code>break-after: page;</code></p>
        <p><strong>Attendu :</strong> Un saut de page devrait √™tre forc√© APR√àS cette section.</p>
        <p><strong>WebKit :</strong> Ignorera cette propri√©t√© moderne.</p>
        <p><strong>WebEngine :</strong> Forcera un saut de page apr√®s ce bloc.</p>
        <p>Le contenu suivant devrait appara√Ætre sur une nouvelle page avec WebEngine.</p>
    </div>

    <!-- Normalement sur une nouvelle page avec WebEngine -->
    <div style="padding: 20px; background: #f0f0f0; margin: 20px 0;">
        <h3>Section suivant le TEST 2</h3>
        <p>Si vous voyez ceci sur la m√™me page que le TEST 2 dans le PDF WebEngine, le test a √©chou√©.</p>
        <p>Si vous voyez ceci sur une NOUVELLE page dans le PDF WebEngine, le test a r√©ussi! ‚úì</p>
    </div>

    <div class="filler">Contenu de remplissage entre les tests</div>

    <!-- TEST 3 -->
    <div class="test3-keep-together">
        <h2>TEST 3: break-inside: avoid
            <span class="status works-webengine">‚úì WebEngine</span>
            <span class="status works-webengine">‚úì WebKit Patch√©</span>
        </h2>
        <p><strong>Propri√©t√© test√©e :</strong> <code>break-inside: avoid;</code></p>
        <p><strong>Attendu :</strong> Ce bloc NE DEVRAIT PAS √™tre coup√© entre deux pages.</p>
        <p><strong>WebKit Patch√© :</strong> Supporte cette propri√©t√© (depuis v0.12.1) pour les blocs non-flottants.</p>
        <p><strong>WebEngine :</strong> Supporte pleinement cette propri√©t√©.</p>

        <p style="margin-top: 30px;">‚ö†Ô∏è <strong>Ce bloc fait 500px de haut pour forcer une situation o√π il pourrait √™tre coup√©.</strong></p>

        <div style="margin-top: 50px; padding: 15px; background: white; border: 2px dashed #4caf50;">
            <h3>Contenu prot√©g√©</h3>
            <p>Tout ce contenu devrait rester ensemble sur la m√™me page.</p>
            <p>Si vous voyez une partie sur une page et le reste sur une autre, le test a √©chou√©.</p>
            <ul style="margin-left: 20px;">
                <li>Premier √©l√©ment de la liste</li>
                <li>Deuxi√®me √©l√©ment de la liste</li>
                <li>Troisi√®me √©l√©ment de la liste</li>
                <li>Quatri√®me √©l√©ment de la liste</li>
            </ul>
        </div>

        <p style="margin-top: 30px;">Si tout ce bloc reste sur une seule page, le test est r√©ussi! ‚úì</p>
    </div>

    <div class="filler">Contenu de remplissage</div>

    <!-- TEST 4 -->
    <div class="test4-flex-container">
        <h2>TEST 4: break-inside: avoid avec display: flex
            <span class="status fails-webkit">‚úó WebKit</span>
            <span class="status fails-webkit">‚úó WebEngine</span>
        </h2>
        <p><strong>Propri√©t√© test√©e :</strong> <code>break-inside: avoid;</code> sur <code>display: flex;</code></p>
        <p><strong>Attendu :</strong> Ce bloc NE DEVRAIT PAS √™tre coup√© entre deux pages.</p>
        <p><strong>PROBL√àME CONNU :</strong> Chromium/Blink ne supporte PAS page-break-inside sur les conteneurs flex!</p>
        <p><strong>R√©sultat probable :</strong> Ce bloc SERA coup√© m√™me avec WebEngine.</p>

        <div style="margin-top: 30px; padding: 15px; background: white; border: 2px dashed #f44336;">
            <h3>‚ö†Ô∏è Contenu Flex (sera probablement coup√©)</h3>
            <p>M√™me avec break-inside: avoid, ce conteneur flex risque d'√™tre coup√©.</p>
            <p><strong>Solution :</strong> Utiliser <code>display: block;</code> au lieu de <code>display: flex;</code> pour le contr√¥le des sauts de page.</p>
        </div>

        <p style="margin-top: 30px;">Si ce bloc est coup√©, c'est normal - c'est une limitation connue de Chromium.</p>
    </div>

    <div class="filler">Contenu de remplissage</div>

    <!-- TEST 5 -->
    <div class="test5-avoid-page">
        <h2>TEST 5: break-inside: avoid-page
            <span class="status works-webengine">‚úì WebEngine</span>
            <span class="status fails-webkit">‚úó WebKit</span>
        </h2>
        <p><strong>Propri√©t√© test√©e :</strong> <code>break-inside: avoid-page;</code></p>
        <p><strong>Attendu :</strong> √âviter les sauts de PAGE (mais permet les sauts de colonnes).</p>
        <p><strong>WebKit :</strong> Ne reconna√Æt pas la valeur <code>avoid-page</code>.</p>
        <p><strong>WebEngine :</strong> Supporte cette valeur sp√©cifique.</p>

        <div style="margin-top: 50px; padding: 15px; background: white; border: 2px dashed #ffc107;">
            <h3>Diff√©rence avec "avoid"</h3>
            <p><code>avoid</code> = √âvite tous les types de ruptures</p>
            <p><code>avoid-page</code> = √âvite uniquement les sauts de page (pas les colonnes)</p>
            <p>Pour un document simple sans colonnes, le r√©sultat est identique √† <code>avoid</code>.</p>
        </div>
    </div>

    <div class="filler">Contenu de remplissage</div>

    <!-- TEST 6 -->
    <div class="test6-left-page">
        <h2>TEST 6: break-before: left
            <span class="status works-webengine">‚úì WebEngine</span>
            <span class="status fails-webkit">‚úó WebKit</span>
        </h2>
        <p><strong>Propri√©t√© test√©e :</strong> <code>break-before: left;</code></p>
        <p><strong>Attendu :</strong> Force un ou deux sauts de page pour que la section commence sur une page de gauche (pour l'impression recto-verso).</p>
        <p><strong>WebKit :</strong> Ne supporte pas les valeurs <code>left</code> et <code>right</code>.</p>
        <p><strong>WebEngine :</strong> Supporte pleinement ces valeurs pour l'impression recto-verso.</p>
        <p>Utile pour les livres imprim√©s o√π les chapitres doivent commencer sur la page de droite!</p>
    </div>

    <!-- TEST 7 -->
    <h2 style="margin-top: 40px;">TEST 7: Tableaux avec break-inside
        <span class="status partial">‚ö† WebKit Patch√©</span>
        <span class="status partial">‚ö† WebEngine</span>
    </h2>
    <p><strong>Propri√©t√© test√©e :</strong> <code>break-inside: avoid;</code> sur tableaux et cellules</p>
    <p><strong>PROBL√àME CONNU :</strong> Les propri√©t√©s de saut de page ne fonctionnent PAS dans les cellules de tableau (<code>&lt;td&gt;</code>).</p>
    <p><strong>WebKit Patch√© :</strong> Support opt-in au niveau des lignes (v0.12.2), r√©p√©tition de THEAD/TFOOT.</p>
    <p><strong>WebEngine :</strong> Chrome ignore page-break dans les cellules de tableau.</p>

    <table class="test7-table">
        <thead>
            <tr>
                <th>Colonne 1</th>
                <th>Colonne 2</th>
                <th>Colonne 3</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Ligne 1, Cellule 1</td>
                <td>Ligne 1, Cellule 2</td>
                <td>Ligne 1, Cellule 3</td>
            </tr>
            <tr>
                <td>Ligne 2, Cellule 1</td>
                <td>Ligne 2, Cellule 2</td>
                <td>Ligne 2, Cellule 3</td>
            </tr>
            <tr>
                <td>Ligne 3, Cellule 1 avec beaucoup de contenu pour tester si les cellules peuvent √™tre coup√©es entre les pages. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</td>
                <td>Ligne 3, Cellule 2 avec beaucoup de contenu pour tester si les cellules peuvent √™tre coup√©es entre les pages. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</td>
                <td>Ligne 3, Cellule 3 avec beaucoup de contenu pour tester si les cellules peuvent √™tre coup√©es entre les pages. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</td>
            </tr>
            <tr>
                <td>Ligne 4, Cellule 1</td>
                <td>Ligne 4, Cellule 2</td>
                <td>Ligne 4, Cellule 3</td>
            </tr>
        </tbody>
    </table>

    <p><strong>R√©sultat attendu :</strong> Les en-t√™tes du tableau devraient se r√©p√©ter sur chaque page avec WebKit patch√©. Les lignes peuvent √™tre coup√©es avec les deux moteurs.</p>

    <div class="filler">Contenu de remplissage</div>

    <!-- TEST 8 -->
    <div class="test8-complex">
        <h2>TEST 8: √âl√©ments imbriqu√©s complexes
            <span class="status works-webengine">‚úì WebEngine</span>
            <span class="status partial">‚ö† WebKit</span>
        </h2>
        <p><strong>Propri√©t√© test√©e :</strong> <code>break-inside: avoid;</code> sur √©l√©ments avec images</p>
        <p><strong>Attendu :</strong> Le bloc entier (texte + image) reste ensemble.</p>

        <div style="margin: 20px 0; padding: 15px; background: white;">
            <h3>Diagramme important</h3>
            <div style="width: 100%; height: 200px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5em;">
                üìä Image ou SVG
            </div>
            <p style="margin-top: 10px;"><strong>L√©gende :</strong> Cette image et sa l√©gende doivent rester ensemble. Si l'image est sur une page et la l√©gende sur une autre, le test a √©chou√©.</p>
        </div>

        <p>WebKit peut parfois couper les images en deux! WebEngine g√®re mieux ce cas.</p>
    </div>

    <div class="filler">Contenu de remplissage</div>

    <!-- TEST 9 -->
    <div class="test9-orphans">
        <h2>TEST 9: Orphans et Widows
            <span class="status works-webengine">‚úì WebEngine</span>
            <span class="status works-webengine">‚úì WebKit v0.12.1+</span>
        </h2>
        <p><strong>Propri√©t√©s test√©es :</strong> <code>orphans: 3;</code> et <code>widows: 3;</code></p>
        <p><strong>Attendu :</strong> Au moins 3 lignes en bas de page (orphans) et 3 lignes en haut de page suivante (widows).</p>
        <p><strong>WebKit Patch√© :</strong> Support ajout√© en v0.12.1 pour les √©l√©ments de type bloc.</p>
        <p><strong>WebEngine :</strong> Support complet.</p>

        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris.</p>
        <p>Nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
        <p>Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium.</p>
        <p>Totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.</p>
    </div>

    <!-- TEST 10 -->
    <div class="test10-column-page">
        <h2>TEST 10: break-before: column
            <span class="status works-webengine">‚úì WebEngine</span>
            <span class="status fails-webkit">‚úó WebKit</span>
        </h2>
        <p><strong>Propri√©t√© test√©e :</strong> <code>break-before: column;</code></p>
        <p><strong>Attendu :</strong> Force un saut de colonne (dans un contexte multi-colonnes).</p>
        <p><strong>WebKit :</strong> Support tr√®s limit√© des valeurs sp√©cifiques aux colonnes.</p>
        <p><strong>WebEngine :</strong> Supporte les sauts de colonnes avec les propri√©t√©s modernes.</p>
        <p>Note : Ce test est plus pertinent dans un document avec <code>column-count</code> ou <code>column-width</code>.</p>
    </div>

    <!-- R√©sum√© final -->
    <div style="margin-top: 60px; padding: 30px; background: #263238; color: white; break-before: page;">
        <h2 style="color: white; border-bottom-color: white;">üìä R√©sum√© des R√©sultats Attendus</h2>

        <div style="margin: 20px 0;">
            <h3 style="color: #81c784;">‚úì Tests qui R√âUSSISSENT avec WebEngine (Chromium)</h3>
            <ul style="margin-left: 20px;">
                <li>TEST 1: break-before: page</li>
                <li>TEST 2: break-after: page</li>
                <li>TEST 3: break-inside: avoid</li>
                <li>TEST 5: break-inside: avoid-page</li>
                <li>TEST 6: break-before: left</li>
                <li>TEST 8: √âl√©ments imbriqu√©s complexes</li>
                <li>TEST 9: orphans et widows</li>
                <li>TEST 10: break-before: column</li>
            </ul>
        </div>

        <div style="margin: 20px 0;">
            <h3 style="color: #e57373;">‚úó Tests qui √âCHOUENT avec WebKit (m√™me patch√©)</h3>
            <ul style="margin-left: 20px;">
                <li>TEST 1: break-before: page (propri√©t√© moderne ignor√©e)</li>
                <li>TEST 2: break-after: page (propri√©t√© moderne ignor√©e)</li>
                <li>TEST 4: break-inside avec display: flex (√©choue partout!)</li>
                <li>TEST 5: break-inside: avoid-page (valeur non reconnue)</li>
                <li>TEST 6: break-before: left (valeur non support√©e)</li>
                <li>TEST 10: break-before: column (support limit√©)</li>
            </ul>
        </div>

        <div style="margin: 20px 0;">
            <h3 style="color: #ffb74d;">‚ö†Ô∏è Tests PARTIELS (comportement variable)</h3>
            <ul style="margin-left: 20px;">
                <li>TEST 3: break-inside: avoid (OK WebKit patch√© v0.12.1+, OK WebEngine)</li>
                <li>TEST 7: Tableaux (support sp√©cial dans les deux, mais limitations)</li>
                <li>TEST 8: Images (WebKit peut couper, WebEngine mieux)</li>
                <li>TEST 9: orphans/widows (OK WebKit v0.12.1+, OK WebEngine)</li>
            </ul>
        </div>

        <div style="margin-top: 30px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 5px;">
            <h3 style="color: #fff59d;">üí° Conclusion</h3>
            <p><strong>Pour un contr√¥le complet des sauts de page via CSS, utilisez WebEngine (Chromium)!</strong></p>
            <p>WebKit patch√© ne supporte que <code>page-break-inside: avoid</code> et les anciennes propri√©t√©s <code>page-break-*</code> limit√©es.</p>
            <p>WebEngine supporte toutes les propri√©t√©s modernes <code>break-before</code>, <code>break-after</code>, <code>break-inside</code> avec leurs valeurs compl√®tes.</p>
        </div>
    </div>

    <!-- Note finale -->
    <div style="margin-top: 40px; padding: 20px; background: #fffde7; border: 2px solid #fbc02d; border-radius: 5px;">
        <h3>üìù Comment interpr√©ter les r√©sultats</h3>
        <ol style="margin-left: 20px;">
            <li><strong>Ouvrez les deux PDFs c√¥te √† c√¥te</strong> (WebKit vs WebEngine)</li>
            <li><strong>Comptez les pages</strong> - WebEngine devrait avoir plus de sauts de page forc√©s</li>
            <li><strong>V√©rifiez que les blocs ne sont pas coup√©s</strong> - Les blocs verts (TEST 3) doivent rester entiers</li>
            <li><strong>Cherchez les nouvelles pages</strong> - TEST 1 et TEST 2 devraient cr√©er des sauts avec WebEngine</li>
            <li><strong>Examinez le r√©sum√© final</strong> - Il devrait √™tre sur une nouvelle page avec WebEngine</li>
        </ol>

        <p style="margin-top: 15px;"><strong>Si vous voyez des diff√©rences significatives, cela prouve que WebEngine offre un bien meilleur contr√¥le des sauts de page!</strong></p>
    </div>

</body>
</html>
